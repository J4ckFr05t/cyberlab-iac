---
- name: Deploy ELK Stack on SIEM Server
  hosts: siem-01-srv
  become: yes
  vars_files:
    - ../inventory/group_vars/secret_vault.yml
  roles:
    - elk_setup
  tags:
    - elk

- name: Setup Fleet Server on Fleet-01-SRV
  hosts: fleet-01-srv
  become: yes
  vars_files:
    - ../inventory/group_vars/secret_vault.yml
  roles:
    - fleet_setup
  tags:
    - fleet

    
- name: Reboot Servers after Deployment
  hosts: "siem-01-srv,fleet-01-srv"
  become: yes
  vars_files:
    - ../inventory/group_vars/secret_vault.yml
  tags:
    - reboot
    - elk
    - fleet
  tasks:
    - name: Notify Rebooting
      debug:
        msg: "Rebooting {{ inventory_hostname }} now..."

    - name: Reboot hosts
      reboot:
        reboot_timeout: 300
